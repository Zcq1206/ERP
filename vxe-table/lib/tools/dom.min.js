"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=exports.browse=exports.DomTools=void 0,exports.getOffsetHeight=getOffsetHeight,exports.getPaddingTopBottomSize=getPaddingTopBottomSize,exports.setScrollLeft=setScrollLeft,exports.setScrollTop=setScrollTop;var _xeUtils=_interopRequireDefault(require("xe-utils")),_utils=_interopRequireDefault(require("./utils"));function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}var getRowid=_utils.default.getRowid,browse=_xeUtils.default.browse();exports.browse=browse;var reClsMap={};function getClsRE(e){return reClsMap[e]||(reClsMap[e]=new RegExp("(?:^|\\s)".concat(e,"(?!\\S)"),"g")),reClsMap[e]}function getNodeOffset(e,t,o){if(e){var l=e.parentNode;if(o.top+=e.offsetTop,o.left+=e.offsetLeft,l&&l!==document.documentElement&&l!==document.body&&(o.top-=l.scrollTop,o.left-=l.scrollLeft),(!t||e!==t&&e.offsetParent!==t)&&e.offsetParent)return getNodeOffset(e.offsetParent,t,o)}return o}function isScale(e){return e&&/^\d+%$/.test(e)}function hasClass(e,t){return e&&e.className&&e.className.match&&e.className.match(getClsRE(t))}function removeClass(e,t){e&&hasClass(e,t)&&(e.className=e.className.replace(getClsRE(t),""))}function getDomNode(){var e=document.documentElement,t=document.body;return{scrollTop:e.scrollTop||t.scrollTop,scrollLeft:e.scrollLeft||t.scrollLeft,visibleHeight:e.clientHeight||t.clientHeight,visibleWidth:e.clientWidth||t.clientWidth}}function getOffsetHeight(e){return e?e.offsetHeight:0}function getPaddingTopBottomSize(e){if(e){var t=getComputedStyle(e);return _xeUtils.default.toNumber(t.paddingTop)+_xeUtils.default.toNumber(t.paddingBottom)}return 0}function setScrollTop(e,t){e&&(e.scrollTop=t)}function setScrollLeft(e,t){e&&(e.scrollLeft=t)}function isNodeElement(e){return e&&1===e.nodeType}var DomTools={browse:browse,isPx:function(e){return e&&/^\d+(px)?$/.test(e)},isScale:isScale,hasClass:hasClass,removeClass:removeClass,addClass:function(e,t){e&&!hasClass(e,t)&&(removeClass(e,t),e.className="".concat(e.className," ").concat(t))},updateCellTitle:function(e,t){var o="html"===t.type?e.innerText:e.textContent;e.getAttribute("title")!==o&&e.setAttribute("title",o)},rowToVisible:function(e,t){var o=e.$refs.tableBody,l=o?o.$el:null;if(l){var r=l.querySelector('[rowid="'.concat(getRowid(e,t),'"]'));if(r){var s=l.clientHeight,i=l.scrollTop,n=r.offsetTop+(r.offsetParent?r.offsetParent.offsetTop:0),f=r.clientHeight;if(n<i||i+s<n)return e.scrollTo(null,n);if(s+i<=n+f)return e.scrollTo(null,i+f)}else if(e.scrollYLoad)return e.scrollTo(null,(e.afterFullData.indexOf(t)-1)*e.scrollYStore.rowHeight)}return Promise.resolve()},colToVisible:function(e,t){var o=e.$refs.tableBody,l=o?o.$el:null;if(l){var r=l.querySelector(".".concat(t.id));if(r){var s=l.clientWidth,i=l.scrollLeft,n=r.offsetLeft+(r.offsetParent?r.offsetParent.offsetLeft:0),f=r.clientWidth;if(n<i||i+s<n)return e.scrollTo(n);if(s+i<=n+f)return e.scrollTo(i+f)}else if(e.scrollXLoad){for(var a=e.visibleColumn,c=0,u=0;u<a.length&&a[u]!==t;u++)c+=a[u].renderWidth;return e.scrollTo(c)}}return Promise.resolve()},getDomNode:getDomNode,getEventTargetNode:function(e,t,o,l){for(var r,s=e.target;s&&s.nodeType&&s!==document;){if(o&&hasClass(s,o)&&(!l||l(s)))r=s;else if(s===t)return{flag:!o||!!r,container:t,targetElem:r};s=s.parentNode}return{flag:!1}},getOffsetPos:function(e,t){return getNodeOffset(e,t,{left:0,top:0})},getAbsolutePos:function(e){var t=e.getBoundingClientRect(),o=t.top,l=t.left,r=getDomNode();return{boundingTop:o,top:r.scrollTop+o,boundingLeft:l,left:r.scrollLeft+l,visibleHeight:r.visibleHeight,visibleWidth:r.visibleWidth}},scrollToView:function(e){var t="scrollIntoViewIfNeeded",o="scrollIntoView";e&&(e[t]?e[t]():e[o]&&e[o]())},triggerEvent:function(e,t){e&&e.dispatchEvent(new Event(t))},calcHeight:function(e,t){var o=e[t],l=0;if(o)if("auto"===o)l=e.parentHeight;else{var r=e.getExcludeHeight();l=isScale(o)?Math.floor((_xeUtils.default.toInteger(o)||1)/100*e.parentHeight):_xeUtils.default.toNumber(o),l=Math.max(40,l-r)}return l},isNodeElement:isNodeElement},_default=exports.DomTools=DomTools;exports.default=_default;